{
	"name": "DEMO: High-Security (Button + BLE)",
	"parameters":
	{
		"relock_timeout_minutes":       "5",
		"ble_scan_fallback_addresses":  "11:11:11:11:11:11,22:22:22:22:22:22",
		"ble_scan_destroyer_addresses": "XX:de:ad:ba:be:XX"
	},
	"workflows": 
	[
		{"name": "SETUP",   "steps":	[{"name": "SETUP:INIT",         "conditions": [{"handlers": ["vault:status=UNPROVISIONED"]}]},
						 {"name": "SETUP:CONFGURATION", "conditions": [{"handlers": ["vault:command=CONFIGURATION"]}]},
						 {"name": "SETUP:CONFIGURED",   "conditions": [{"handlers": ["vault:status=CONFIGURED"]}]},
						 {"name": "SETUP:ENROLLMENT",   "conditions": [{"handlers": ["vault:command=ENROLLMENT"]}]},
						 {"name": "SETUP:ENROLLED",     "conditions": [{"handlers": ["vault:status=ENROLLED"]}]},
						 {"name": "SETUP:LOOT",         "conditions": [{"handlers": ["vault:command=LOOT"]}]},
						 {"name": "SETUP:LOOTED",       "conditions": [{"handlers": ["vault:status=LOOTED"]}]},
						 {"name": "SETUP:READY",        "conditions": [{"handlers": ["vault:command=READY"]}]}
						]
		},
		{"name": "UNLOCK",  "steps":	[{"name": "UNLOCK:INIT",        "conditions": [{"handlers": ["vault:status=LOCKED","reset:reason=POWER_ON"]}]},
						 {"name": "UNLOCK:BTN",         "conditions": [{"handlers": ["reset:reason=RESET_PIN"]}]},
						 {"name": "UNLOCK:BLE",         "conditions": [{"handlers": ["ble:connections=1+","ble:scan-any={ble_scan_fallback_addresses}"]}]},
						 {"name": "UNLOCKED"}
						]
		},
		{"name": "RELOCK",  "steps":	[{"name": "RELOCK:INIT",         "conditions": [{"handlers": ["vault:status=UNLOCKED"]}]},
						 {"name": "RELOCK:CLK+BLE",      "conditions": [{"handlers": ["timeout:minutes={relock_timeout_minutes}#relock", "ble:connections=0"]}, 
						                                                {"handlers": ["timeout:minutes={relock_timeout_minutes}#relock", "ble:scan-none={ble_scan_fallback_addresses}"]}]},
						 {"name": "RELOCKED"}
						]
		},
		{"name": "DESTROY", "steps":	[{"name": "DESTROY:INIT", "conditions": [{"handlers": ["vault:status=LOCKED"]}]},
						 {"name": "DESTROY:BLE",  "conditions": [{"handlers": ["ble:scan-any={ble_scan_destroyer_addresses}"]}]},
						 {"name": "DESTROYED"}
						]
		}
	]
}

